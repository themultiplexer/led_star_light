import socket
import time
import zlib

def send_tcp_message(sock, hex_message):
    # Convert the hex string to bytes
    message_bytes = bytes.fromhex(hex_message)
    sock.sendall(message_bytes)
    print(f"Sent message: {hex_message}")


arr = [
"000055aa000004100000001000000018f04eb0b3fe90671d7ad30750b0725f9ca7f3d0e90000aa55"
"000055aa000004110000000d00000037332e33000000000000001400097d05d61b9e317c2ea369291e42218902f4fdbb09328ff6cb29b2623305933d148e10749506180000aa55"
"000055aa000004120000000d00000047332e33000000000000001500097d05d61b9e317c2ea369291e42218902f4fd5d1edddd2e3f59e36bce278135af5a7a2a1c1cfd96e976c5e6067f6943a472e54941cc610000aa55",
"000055aa000004130000000d00000047332e33000000000000001600097d05d61b9e317c2ea369291e42218902f4fd5d1edddd2e3f59e36bce278135af5a7adea0bab81d3d0ed9f19ecb01c63616332be3e16b0000aa55",
"000055aa000004140000000d00000047332e33000000000000001700097d05d61b9e317c2ea369291e42218902f4fd5d1edddd2e3f59e36bce278135af5a7a93a980496b5ea46baf515191a2b87a326a4da2df0000aa55",
"000055aa000004150000000d00000047332e33000000000000001800097d05d61b9e317c2ea369291e42218902f4fd788a2c81f1f2b9f458f89122b2e04e0793a980496b5ea46baf515191a2b87a322216950b0000aa55",
"000055aa000004160000000d00000047332e33000000000000001900097d05d61b9e317c2ea369291e42218902f4fd77d3d654663f7308345587ba4706794093a980496b5ea46baf515191a2b87a32d60a48c00000aa55",
"000055aa00000000000000090000000865930c220000aa55",
"000055aa000004170000000d00000047332e33000000000000001a00097d05d61b9e317c2ea369291e42218902f4fde8501462188d6458be8ef6a419e0431a93a980496b5ea46baf515191a2b87a32503bad0c0000aa55",
"000055aa000004180000000d00000047332e33000000000000001b00097d05d61b9e317c2ea369291e42218902f4fd787c362b22e5ff9133f0c294cc6fcfc293a980496b5ea46baf515191a2b87a32d6fd371a0000aa55",
"000055aa000004190000000d00000047332e33000000000000001c00097d05d61b9e317c2ea369291e42218902f4fd168cf6159bab4528849d11a0f4a9beab93a980496b5ea46baf515191a2b87a32ffd2acec0000aa55",
"000055aa0000041a0000000d00000047332e33000000000000001d00097d05d61b9e317c2ea369291e42218902f4fd75db74601865b82bab986f3dc107503693a980496b5ea46baf515191a2b87a32593ee15c0000aa55",
"000055aa0000041b0000000d00000047332e33000000000000001e00097d05d61b9e317c2ea369291e42218902f4fd044641efb43bc5ee693feca451cdca0193a980496b5ea46baf515191a2b87a320e9dbf480000aa55",
"000055aa0000041c0000000d00000047332e33000000000000001f00097d05d61b9e317c2ea369291e42218902f4fd23f8eedd0acf09383042384a0f3c98b693a980496b5ea46baf515191a2b87a324101c7160000aa55",
"000055aa0000041d0000000d00000047332e33000000000000002000097d05d61b9e317c2ea369291e42218902f4fd61057c7285601a79e6604140e6f0387b93a980496b5ea46baf515191a2b87a321bd42cbb0000aa55",
"000055aa0000041e0000000d00000047332e33000000000000002100097d05d61b9e317c2ea369291e42218902f4fdd0ca40ceb4cbc4fb715ff23453f7c99e93a980496b5ea46baf515191a2b87a32681434d20000aa55",
"000055aa0000041f0000000d00000047332e33000000000000002200097d05d61b9e317c2ea369291e42218902f4fd2a28633044d6db12971c3f7b87fecd0e93a980496b5ea46baf515191a2b87a326cd5f9c70000aa55",
"000055aa000004200000000d00000047332e33000000000000002300097d05d61b9e317c2ea369291e42218902f4fd9547b695b649b32f0f3cc3c57d2e499293a980496b5ea46baf515191a2b87a32c69080720000aa55",
"000055aa00000000000000090000000865930c220000aa55",
"000055aa000004210000000d00000047332e33000000000000002400097d05d61b9e317c2ea369291e42218902f4fdfb23044f1322dc4c86bc289f2b4dd92e93a980496b5ea46baf515191a2b87a3225f49b930000aa55",
"000055aa000004220000000d00000047332e33000000000000002500097d05d61b9e317c2ea369291e42218902f4fd5509344191623c64a30add41916342db93a980496b5ea46baf515191a2b87a3254e7802f0000aa55",
"000055aa000004230000000d00000047332e33000000000000002600097d05d61b9e317c2ea369291e42218902f4fdeffc81e87ba1f27b24b89f7e82238e3193a980496b5ea46baf515191a2b87a3263aa33ee0000aa55",
"000055aa000004240000000d00000047332e33000000000000002700097d05d61b9e317c2ea369291e42218902f4fde1d1cffc0da51833fb244f625562940c93a980496b5ea46baf515191a2b87a32e326616d0000aa55",
"000055aa000004250000000d00000047332e33000000000000002800097d05d61b9e317c2ea369291e42218902f4fdc34fe28ec8434f0526a317a6ed20527093a980496b5ea46baf515191a2b87a32c354584d0000aa55",
"000055aa000004260000000d00000047332e33000000000000002900097d05d61b9e317c2ea369291e42218902f4fd8f329be0b9cc50b8fe7a2ed9e2a3b86b93a980496b5ea46baf515191a2b87a321f7c28750000aa55",
"000055aa000004270000000d00000047332e33000000000000002a00097d05d61b9e317c2ea369291e42218902f4fdff1b21b2f8e4144cbee389c564c86f4693a980496b5ea46baf515191a2b87a3291b5ba830000aa55",
"000055aa000004280000000d00000047332e33000000000000002b00097d05d61b9e317c2ea369291e42218902f4fd7e00afaddc87eb4b71a5db9b6e6998c293a980496b5ea46baf515191a2b87a32f703a5530000aa55",
"000055aa000004290000000d00000047332e33000000000000002c00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb64493a980496b5ea46baf515191a2b87a32065c0d0c0000aa55",
"000055aa00000000000000090000000865930c220000aa55",
"000055aa0000042a0000000d00000047332e33000000000000002d00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb64428fb46f146fa702e586b281312bef0e7728897e80000aa55",
"000055aa0000042b0000000d00000047332e33000000000000002e00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644518f1967bb9ed848a30f36bc0982afb1b808fff10000aa55",
"000055aa0000042c0000000d00000047332e33000000000000002f00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb6446bdb470c324f3fd9a4c51cf42d1cd6b8f66975530000aa55",
"000055aa0000042d0000000d00000047332e33000000000000003000097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb64487967c7df6b086dda29c2751f3d4af800391726f0000aa55",
"000055aa0000042e0000000d00000047332e33000000000000003100097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644795a845debffaf00a3490ca20796ac4f53cb9b240000aa55",
"000055aa0000042f0000000d00000047332e33000000000000003200097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb6448d2bb3be418f6a4c2fe20568beb6dea2df2839200000aa55",
"000055aa00000000000000090000000865930c220000aa55",
"000055aa000004300000000d00000047332e33000000000000003300097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644292f2cb7f8319c85cb6eeb990f2e171e9ee0f8730000aa55",
"000055aa000004310000000d00000047332e33000000000000003400097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb6449d1b5bf95e5f996102b80496bcc6b52eaaab75f60000aa55",
"000055aa000004320000000d00000047332e33000000000000003500097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644f93fdde93cacbe9b66e5f360b77c5d46b437cb4d0000aa55",
"000055aa000004330000000d00000047332e33000000000000003600097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb64479cfe9d373d5b7ad6549d1da5b37132fc0ec349d0000aa55",
"000055aa000004340000000d00000047332e33000000000000003700097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644a0f07161e736be206718f266b61d3df33ee5c19f0000aa55",
"000055aa000004350000000d00000047332e33000000000000003800097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb64493a980496b5ea46baf515191a2b87a32e3a802670000aa55",
"000055aa00000000000000090000000865930c220000aa55",
"000055aa000004360000000d00000047332e33000000000000003900097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb64490e748a10dba303938cd7787888e0ffe67b915770000aa55",
"000055aa000004370000000d00000047332e33000000000000003a00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644dee6cef1a5436b999677232dfe76862bd9f24a170000aa55",
"000055aa000004380000000d00000047332e33000000000000003b00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644b6bc72759bdc0d5740a36abb0a64ea2bc7b872b00000aa55",
"000055aa000004390000000d00000047332e33000000000000003c00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644822277565506875c56d4bf8f5c4dbc90499745210000aa55",
"000055aa0000043a0000000d00000047332e33000000000000003d00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb6448d2d53687d57ec22bf59f72a45a96323a2dd8b540000aa55",
"000055aa0000043b0000000d00000047332e33000000000000003e00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644b88e42ae0847745142009e66d0402323203c746a0000aa55",
"000055aa0000043c0000000d00000047332e33000000000000003f00097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644674322ecb375501dae457e588f06bba07a2575f90000aa55",
"000055aa00000000000000090000000865930c220000aa55",
"000055aa0000043d0000000d00000047332e33000000000000004000097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644a61f6d6ffb6bcf25ddb9e3259463f816633986620000aa55",
"000055aa0000043e0000000d00000047332e33000000000000004100097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb6449c7f7c7827defa0630138240b42380dfbf9f6d9a0000aa55",
"000055aa0000043f0000000d00000047332e33000000000000004200097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb644708c5306c13ea1e547ab723a0adeb12dd65551ad0000aa55",
"000055aa000004400000000d00000047332e33000000000000004300097d05d61b9e317c2ea369291e42218902f4fd2b5dcf021689d3c6511b2d77332fb64493a980496b5ea46baf515191a2b87a32a18e466e0000aa55"
]

arr2= [
"000055aa000006a10000000d00000037332e33000000000000000d00065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4613f0e950000aa55",
"000055aa000006a20000000d00000037332e33000000000000000e00065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a2cad62240000aa55",
"000055aa000006a30000000d00000037332e33000000000000000f00065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4808401440000aa55",
"000055aa000006a40000000d00000037332e33000000000000001000065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a6b8b85d50000aa55",
"000055aa000006a50000000d00000037332e33000000000000001100065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4c7a2e6b50000aa55",
"000055aa000006a60000000d00000037332e33000000000000001200065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a8a308a040000aa55",
"000055aa000006a70000000d00000037332e33000000000000001300065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a42619e9640000aa55",
"000055aa000006a80000000d00000037332e33000000000000001400065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a9f24028e0000aa55",
"000055aa000006a90000000d00000037332e33000000000000001500065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4330d61ee0000aa55",
"000055aa000006aa0000000d00000037332e33000000000000001600065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a7e9f0d5f0000aa55",
"000055aa000006ab0000000d00000037332e33000000000000001700065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4d2b66e3f0000aa55",
"000055aa000006ac0000000d00000037332e33000000000000001800065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a5b85b6130000aa55",
"000055aa000006ad0000000d00000037332e33000000000000001900065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4f7acd5730000aa55",
"000055aa000006ae0000000d00000037332e33000000000000001a00065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4aba3eb9c20000aa55",
"000055aa000006af0000000d00000037332e33000000000000001b00065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a41617daa20000aa55",
"000055aa000006b00000000d00000037332e33000000000000001c00065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4aad0a0a790000aa55",
"000055aa000006b10000000d00000037332e33000000000000001d00065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4012369190000aa55",
"000055aa000006b20000000d00000037332e33000000000000001e00065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a4cb105a80000aa55",
"000055aa000006b30000000d00000037332e33000000000000001f00065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4e09866c80000aa55",
"000055aa000006b40000000d00000037332e33000000000000002000065a4e97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4acfef5b230000aa55",
"000055aa000006b50000000d00000037332e33000000000000002100065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a463c638430000aa55"
]


arr3 = [
"000055aa000006420000000d00000037332e330000000000000004000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4d5e3e84c0000aa55",
"000055aa000006430000000d00000037332e330000000000000005000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a79ca8b2c0000aa55",
"000055aa000006440000000d00000037332e330000000000000006000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4420ca8c10000aa55",
"000055aa000006450000000d00000037332e330000000000000007000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4aee25cba10000aa55",
"000055aa000006460000000d00000037332e330000000000000008000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a411425cd10000aa55",
"000055aa000006470000000d00000037332e330000000000000009000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4abd6b3fb10000aa55",
"000055aa000006480000000d00000037332e33000000000000000a000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a46a0582e40000aa55",
"000055aa000006490000000d00000037332e33000000000000000b000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4ac62ce1840000aa55",
"000055aa0000064a0000000d00000037332e33000000000000000c000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4e5eddb8a0000aa55",
"000055aa0000064b0000000d00000037332e33000000000000000d000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a49c4b8ea0000aa55",
"000055aa0000064c0000000d00000037332e33000000000000000e000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a472029b070000aa55",
"000055aa0000064d0000000d00000037332e33000000000000000f000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4ade2bf8670000aa55",
"000055aa0000064e0000000d00000037332e330000000000000010000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4437033aa0000aa55",
"000055aa0000064f0000000d00000037332e330000000000000011000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4aef5950ca0000aa55",
"000055aa000006500000000d00000037332e330000000000000012000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a43a17d6ae0000aa55",
"000055aa000006510000000d00000037332e330000000000000013000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a963eb5ce0000aa55",
"000055aa000006520000000d00000037332e330000000000000014000a802ae294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4b5ff8fc00000aa55"
]

for a in range(0,len(arr2), 2):
    data = arr2[a]
    payload = data[0:126]

    crc_checksum = zlib.crc32(bytes.fromhex(payload))

    check = data[126:134]
    print(payload)
    print(" ", check, hex(crc_checksum))

# Create a TCP socket
with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect(("192.168.1.235", 6668))

    time.sleep(1)
    send_tcp_message(sock, "000055aa00000000000000090000000865930c220000aa55")
    data=sock.recv(28+91)
    print(''.join('{:02x}'.format(x) for x in data))
    time.sleep(2.0)
    send_tcp_message(sock, "000055aa000006a10000000d00000037332e33000000000000000d00065a4ee294d4ce0d3852e421e0aed7313f5c0656b333f24acbd27900551d55b51c96a4613f0e950000aa55")
    data=sock.recv(28+91)
    print(''.join('{:02x}'.format(x) for x in data))
    time.sleep(2.0)

    send_tcp_message(sock, "000055aa000006430000000d00000037332e330000000000000005000a802a97b0ecbbb191e8e65ec46176b940fbb91664daeb717f299f22ebb393e4363d4a79ca8b2c0000aa55")
    data=sock.recv(28+91)
    print(''.join('{:02x}'.format(x) for x in data))
    time.sleep(2.0)

    send_tcp_message(sock, "000055aa000004110000000d00000037332e33000000000000001400097d05d61b9e317c2ea369291e42218902f4fdbb09328ff6cb29b2623305933d148e10749506180000aa55")
    data=sock.recv(28+91)
    print(''.join('{:02x}'.format(x) for x in data))

